#### In short
```
python3 solv.py
```

```
ï£¿ ~/ python3 solv.py
TetCTF{just_hack}
```


#### Explanation

This is AMF service, learning around you can know where the endpoint located
in tetctf.war: WEB-INF/flex/services-config.xml
```
        <channel-definition id="tetctf-amf" class="mx.messaging.channels.AMFChannel">
            <endpoint url="http://{server.name}:{server.port}/{context.root}/messagebroker/amf" class="flex.messaging.endpoints.AMFEndpoint"/>
        </channel-definition>
```
Its and endpoint that we can send AMF packet to interactive with the server (google for the AMF packet structure, or refer to genAMF() in solv.py)

Checking the version, it seems vulnerable to CVE-2015-3269
https://codewhitesec.blogspot.com/2015/08/cve-2015-3269-apache-flex-blazeds-xxe.html

The problems here are:
- We cant direct get data from XXE or blind XXE
- Some keywords are blacklisted (SecurityFilter.class)
```
    public static String pattern = "(file|ftp|http|https|data|class|bash|logs|log|conf|etc|session|proc|root|history)";
```

From this article: 
https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation/

we can do error xxe thanks to local dtd to leak the data

First check if there are any local .dtd/.jar file inside the system


pick 1 payload from here
https://github.com/GoSecure/dtd-finder/blob/master/list/xxe_payloads.md
